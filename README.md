
## sidecred

[![go.dev reference](https://img.shields.io/badge/go.dev-reference-007d9c?logo=go&logoColor=white&style=flat-square)](https://pkg.go.dev/github.com/telia-oss/sidecred)
[![latest release](https://img.shields.io/github/v/release/telia-oss/sidecred?style=flat-square)](https://github.com/telia-oss/sidecred/releases/latest)
[![build status](https://img.shields.io/github/workflow/status/telia-oss/sidecred/workflow?label=build&logo=github&style=flat-square)](https://github.com/telia-oss/sidecred/actions?query=workflow%3Atest)

Sidecred handles the lifecycle of your credentials "on the side". It supports multiple credential providers and secret stores, and handles the lifecycle from creation, to rotations and eventual deletion.

## Supported Credential Stores

Credential stores are used to store credentials generated by providers. The following credential stores are supported:

* In-process
* AWS Secrets Manager
* AWS Systems Manager (SSM)

## Supported Providers

Credential providers are used to generate provider specific credentials. For example, the GitHub provider is responsible for generating GitHub access tokens and deploy keys. The following credential providers are supported:

* Github (access tokens and deploy keys)
* AWS STS
* Random
* [Artifactory](./provider/artifactory/README.md)

## Supported Backends

Backends are where `sidecred` stores internal state. This state is used for various purposes, such as storing credential expiry.

The following backends are supported:

* File
* AWS S3

## Development

### Local

```bash
# Enable the STS provider
export AWS_REGION=eu-west-1
export SIDECRED_STS_PROVIDER_ENABLED=true
export SIDECRED_STS_PROVIDER_SESSION_DURATION=20m

# Enable the Github provider
export SIDECRED_GITHUB_PROVIDER_ENABLED=true
export SIDECRED_GITHUB_PROVIDER_KEY_ROTATION_INTERVAL=20m

# Chose a secret store and configure it
export SIDECRED_SECRET_STORE_BACKEND=ssm
export SIDECRED_SSM_STORE_PATH_TEMPLATE="/sidecred/{{ .Namespace }}/{{ .Name }}"

# Chose a state backend and configure it
export SIDECRED_STATE_BACKEND=file

# Enable debug logging
export SIDECRED_DEBUG=true
```

After setting the above you can execute `sidecred` as follows:

```bash
# The Github App credentials (integration ID and private key) and AWS STS credentials
# should be populated using e.g. vaulted or aws-vault:
go run ./cmd/sidecred --namespace e2e --config ./cmd/sidecred/testdata/config.yml
```
